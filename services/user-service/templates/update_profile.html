{% extends "base.html" %}

{% block title %}Cập Nhật Hồ Sơ{% endblock %}
{% block page_title %}Chỉnh Sửa Thông Tin Cá Nhân{% endblock %}

{% block content %}

<!-- Form Cập Nhật Chi Tiết Profile (POST to /profile_update) -->
<div class="form-section">
    <h3>Thông Tin Cơ Bản</h3>
    <form action="{{ url_for('profile_site.update_profile') }}" method="POST">
        
        <div>
            <label for="new_fullname">Họ và Tên:</label>
            <input type="text" id="new_fullname" name="new_fullname" 
                   value="{{ profile.full_name or '' }}" placeholder="Nhập tên đầy đủ">
        </div>
        <div>
            <label for="new_phone_number">Số điện thoại:</label>
            <input type="text" id="new_phone_number" name="new_phone_number" 
                   value="{{ profile.phone_number or '' }}" placeholder="Nhập số điện thoại">
        </div>
        <div>
            <label for="new_address">Địa chỉ:</label>
            <input type="text" id="new_address" name="new_address" 
                   value="{{ profile.address or '' }}" placeholder="Nhập địa chỉ">
        </div>
        <div>
            <label for="new_bio">Tiểu sử/Giới thiệu:</label>
            <textarea id="new_bio" name="new_bio" rows="4" placeholder="Viết một chút về bản thân...">{{ profile.bio or '' }}</textarea>
        </div>
        <button type="submit">Lưu Thông Tin</button>
    </form>
</div>

<hr style="margin: 30px 0; border-color: #eee;">

<!-- Form Cập Nhật Avatar (POST to /update_avatar) -->
<div class="form-section">
    <h3>Ảnh Đại Diện (Avatar)</h3>
    <div style="text-align: center; margin-bottom: 20px;">
        <img src="{{ profile.avatar_url or 'https://placehold.co/100x100/007bff/ffffff?text=Avatar' }}" 
             alt="Ảnh đại diện hiện tại" 
             style="width: 100px; height: 100px; border-radius: 50%; object-fit: cover; border: 2px solid #ddd;">
    </div>
    
    <form action="{{ url_for('profile_site.update_avatar') }}" method="POST" enctype="multipart/form-data">
        <div>
            <label for="avatar_file">Chọn file ảnh mới:</label>
            <input type="file" id="avatar_file" name="avatar" accept="image/*" required>
        </div>
        <button type="submit">Cập Nhật Avatar</button>
    </form>
</div>

<div style="margin-top: 30px;">
    <a href="{{ url_for('profile_site.get_profile') }}" class="link">Quay lại Hồ Sơ</a>
</div>

<style>
    .form-section {
        padding: 20px;
        border: 1px solid #ddd;
        border-radius: 8px;
        margin-bottom: 20px;
        background-color: #f7f7f7;
    }
    .form-section h3 {
        color: #007bff;
        border-bottom: 1px dashed #ccc;
        padding-bottom: 10px;
        margin-top: 0;
        margin-bottom: 20px;
    }
</style>
{% endblock %}
